(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[158],{125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},13:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(117),r=a.n(s),o=a(39),l=a(79),c=a(23),h=a(53),u=a(67),d=a(38),m=a(68),p=a(43),g=a(61),f=a(62),v=a(78),b=new(function(){function e(){Object(n.a)(this,e),this.refs=[],this.socket=null,this.default_url="http://localhost:8000",this.connected=!1,this.initialMemoryState={objects:new Map,humans:new Map,chatResponse:{},chats:[{msg:"",failed:!1},{msg:"",failed:!1},{msg:"",failed:!1},{msg:"",failed:!1},{msg:"",failed:!1}],timelineHandshake:"",timelineEvent:"",timelineEventHistory:[]},this.processMemoryState=this.processMemoryState.bind(this),this.setChatResponse=this.setChatResponse.bind(this),this.setConnected=this.setConnected.bind(this),this.updateStateManagerMemory=this.updateStateManagerMemory.bind(this),this.keyHandler=this.keyHandler.bind(this),this.updateVoxelWorld=this.updateVoxelWorld.bind(this),this.setVoxelWorldInitialState=this.setVoxelWorldInitialState.bind(this),this.memory=this.initialMemoryState,this.processRGB=this.processRGB.bind(this),this.processDepth=this.processDepth.bind(this),this.processRGBDepth=this.processRGBDepth.bind(this),this.processObjects=this.processObjects.bind(this),this.showAssistantReply=this.showAssistantReply.bind(this),this.processHumans=this.processHumans.bind(this),this.processMap=this.processMap.bind(this),this.returnTimelineHandshake=this.returnTimelineHandshake.bind(this),this.returnTimelineEvent=this.returnTimelineEvent.bind(this);var t=new URLSearchParams(window.location.search),a=t.get("turk_experiment_id"),i=t.get("mephisto_agent_id"),s=t.get("turk_worker_id");this.setTurkExperimentId(a),this.setMephistoAgentId(i),this.setTurkWorkerId(s),this.default_url=window.location.host,this.setUrl(this.default_url);var r=localStorage.getItem("server_url");"undefined"!==r&&void 0!==r&&null!==r||(r=this.default_url),this.setUrl(r),this.fps_time=performance.now()}return Object(i.a)(e,[{key:"setDefaultUrl",value:function(){localStorage.removeItem("server_url"),this.setUrl(this.default_url)}},{key:"setUrl",value:function(e){this.url=e,localStorage.setItem("server_url",e),this.restart(this.url)}},{key:"setTurkExperimentId",value:function(e){localStorage.setItem("turk_experiment_id",e)}},{key:"getTurkExperimentId",value:function(){return localStorage.getItem("turk_experiment_id")}},{key:"setMephistoAgentId",value:function(e){localStorage.setItem("mephisto_agent_id",e)}},{key:"getMephistoAgentId",value:function(){return localStorage.getItem("mephisto_agent_id")}},{key:"setTurkWorkerId",value:function(e){localStorage.setItem("turk_worker_id",e)}},{key:"getTurkWorkerId",value:function(){return localStorage.getItem("turk_worker_id")}},{key:"restart",value:function(e){var t=this;this.socket=r.a.connect(e,{transports:["polling","websocket"]});var a=this.socket;a.on("reconnect_attempt",(function(){a.io.opts.transports=["polling","websocket"]})),a.on("connect",(function(e){console.log("connect event"),t.setConnected(!0),t.socket.emit("get_memory_objects")})),a.on("reconnect",(function(e){console.log("reconnect event"),t.setConnected(!0),t.socket.emit("get_memory_objects")})),a.on("disconnect",(function(e){console.log("disconnect event"),t.setConnected(!1),t.memory=t.initialMemoryState,t.refs.forEach((function(e){e.setState(e.initialState),e.forceUpdate()})),console.log("disconnected")})),a.on("setChatResponse",this.setChatResponse),a.on("memoryState",this.processMemoryState),a.on("updateState",this.updateStateManagerMemory),a.on("rgb",this.processRGB),a.on("depth",this.processDepth),a.on("image",this.processRGBDepth),a.on("objects",this.processObjects),a.on("updateVoxelWorldState",this.updateVoxelWorld),a.on("setVoxelWorldInitialState",this.setVoxelWorldInitialState),a.on("showAssistantReply",this.showAssistantReply),a.on("humans",this.processHumans),a.on("map",this.processMap),a.on("returnTimelineHandshake",this.returnTimelineHandshake),a.on("newTimelineEvent",this.returnTimelineEvent)}},{key:"updateStateManagerMemory",value:function(e){this.memory=e.memory,this.refs.forEach((function(e){e.forceUpdate()}))}},{key:"setConnected",value:function(e){this.connected=e,this.refs.forEach((function(t){t instanceof h.a&&t.setState({connected:e})}))}},{key:"setChatResponse",value:function(e){this.memory.chats=e.allChats,this.memory.chatResponse[e.chat]=e.chatResponse,this.refs.forEach((function(t){t instanceof p.a&&t.setState({status:e.status}),t instanceof m.a&&t.forceUpdate()}))}},{key:"updateVoxelWorld",value:function(e){this.refs.forEach((function(t){t instanceof g.a&&(console.log("update Voxel World with "+e.world_state),t.setState({world_state:e.world_state,status:e.status}))}))}},{key:"setVoxelWorldInitialState",value:function(e){this.refs.forEach((function(t){t instanceof g.a&&(console.log("set Voxel World Initial state: "+e.world_state),t.setState({world_state:e.world_state,status:e.status}))}))}},{key:"showAssistantReply",value:function(e){this.refs.forEach((function(t){t instanceof p.a&&(console.log("set assistant reply"),t.setState({agent_reply:e.agent_reply}))}))}},{key:"returnTimelineHandshake",value:function(e){this.memory.timelineHandshake=e,this.refs.forEach((function(e){e instanceof f.a&&e.forceUpdate()}))}},{key:"returnTimelineEvent",value:function(e){this.memory.timelineEventHistory.push(e),this.memory.timelineEvent=e,this.refs.forEach((function(e){e instanceof f.a&&e.forceUpdate()}))}},{key:"keyHandler",value:function(e){var t=[],a=[];for(var n in e){var i=e[n];n=parseInt(n),a.push(n),!0===i&&(38===n&&t.push("MOVE_FORWARD"),40===n&&t.push("MOVE_BACKWARD"),37===n&&t.push("MOVE_LEFT"),39===n&&t.push("MOVE_RIGHT"),49===n&&t.push("PAN_LEFT"),50===n&&t.push("PAN_RIGHT"),51===n&&t.push("TILT_UP"),52===n&&t.push("TILT_DOWN"))}if(t.length>0)for(var s in this.socket.emit("movement command",t),a)e[a[s]]=!1}},{key:"buttonHandler",value:function(e){e.length>0&&this.socket.emit("movement command",e)}},{key:"processMemoryState",value:function(e){this.refs.forEach((function(t){t instanceof l.a&&t.setState({isLoaded:!0,memory:e})}))}},{key:"processRGB",value:function(e){var t=new Image;t.src="data:image/webp;base64,"+e,this.refs.forEach((function(e){e instanceof c.a&&"rgb"===e.props.type&&e.setState({isLoaded:!0,rgb:t})}))}},{key:"processDepth",value:function(e){var t=new Image;t.src="data:image/webp;base64,"+e,this.refs.forEach((function(e){e instanceof c.a&&"depth"===e.props.type&&e.setState({isLoaded:!0,depth:t})}))}},{key:"processRGBDepth",value:function(e){this.processRGB(e.rgb),this.processDepth(e.depth)}},{key:"processObjects",value:function(e){if(-1!==e.image&&void 0!==e.image){var t=new Image;t.src="data:image/webp;base64,"+e.image.rgb,this.refs.forEach((function(a){a instanceof u.a?a.setState({isLoaded:!0,objects:e.objects,rgb:t}):a instanceof v.a&&a.setState({objectRGB:t})}))}}},{key:"processHumans",value:function(e){if(-1!==e.image&&void 0!==e.image){var t=new Image;t.src="data:image/webp;base64,"+e.image.rgb,this.refs.forEach((function(a){a instanceof d.a&&a.setState({isLoaded:!0,humans:e.humans,rgb:t})}))}}},{key:"processMap",value:function(e){var t=this;this.refs.forEach((function(a){a instanceof o.a&&a.setState({isLoaded:!0,memory:t.memory,bot_xyz:[e.x,e.y,e.yaw],obstacle_map:e.map})}))}},{key:"connect",value:function(e){this.refs.push(e)}},{key:"disconnect",value:function(e){this.refs=this.refs.filter((function(t){return t!==e}))}}]),e}());t.a=b},130:function(e,t,a){},132:function(e,t,a){},133:function(e,t,a){},134:function(e,t,a){},136:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(7),r=a(6),o=a(0),l=a.n(o),c=a(23),h=a(67),u=a(38),d=a(43),m=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={rgb:null,depth:null,objects:null,humans:null},i}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.stateManager;return l.a.createElement("div",null,l.a.createElement(d.a,{stateManager:e}),l.a.createElement(c.a,{type:"rgb",height:320,width:320,offsetH:400,offsetW:10,stateManager:e}),l.a.createElement(c.a,{type:"depth",height:320,width:320,offsetH:400,offsetW:340,stateManager:e}),l.a.createElement(h.a,{height:320,width:320,offsetH:730,offsetW:10,stateManager:e}),l.a.createElement(u.a,{height:320,width:320,offsetH:730,offsetW:340,stateManager:e}))}}]),a}(l.a.Component);t.a=m},181:function(e,t,a){},23:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(8),r=a(7),o=a(6),l=a(0),c=a.n(l),h=a(41),u=a(12),d=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).onResize=i.onResize.bind(Object(s.a)(i)),i.initialState={height:e.height,width:e.width,rgb:null,depth:null},i.state=i.initialState,i}return Object(i.a)(a,[{key:"onResize",value:function(e,t,a,n,i){this.setState({width:parseInt(a.style.width,10),height:parseInt(a.style.height,10)})}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this)}},{key:"componentWillUnmount",value:function(){this.props.stateManager&&this.props.stateManager.disconnect(this)}},{key:"render",value:function(){var e=this.state,t=e.height,a=e.width,n=e.rgb,i=e.depth,s=this.props,r=s.offsetW,o=s.offsetH,l=s.isMobile,d=n;return null===n&&null==i?l?c.a.createElement("p",null,"Loading..."):c.a.createElement(h.a,{default:{x:r,y:o,width:a,height:t},lockAspectRatio:!0,onResize:this.onResize},c.a.createElement("p",null,"Loading...")):("depth"===this.props.type&&(d=i),l?c.a.createElement(u.Stage,{width:a,height:t},c.a.createElement(u.Layer,null,c.a.createElement(u.Image,{image:d,width:a,height:t}))):c.a.createElement(h.a,{default:{x:r,y:o,width:a,height:t},lockAspectRatio:!0,onResize:this.onResize},c.a.createElement(u.Stage,{width:a,height:t},c.a.createElement(u.Layer,null,c.a.createElement(u.Image,{image:d,width:a,height:t})))))}}]),a}(c.a.Component);t.a=d},38:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(8),r=a(7),o=a(6),l=a(0),c=a.n(l),h=a(41),u=a(12),d=a(121),m=[["left_ear","left_eye"],["right_ear","right_eye"],["left_eye","right_eye"],["left_eye","nose"],["right_eye","nose"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"],["right_hip","left_hip"],["right_shoulder","left_shoulder"]],p=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).onResize=i.onResize.bind(Object(s.a)(i)),i.initialState={height:e.height,width:e.width,rgb:null,humans:null},i.state=i.initialState,i}return Object(i.a)(a,[{key:"onResize",value:function(e,t,a,n,i){this.setState({width:parseInt(a.style.width,10),height:parseInt(a.style.height,10)})}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this)}},{key:"componentWillUnmount",value:function(){this.props.stateManager&&this.props.stateManager.disconnect(this)}},{key:"render",value:function(){var e=this.state,t=e.height,a=e.width,n=e.rgb,i=e.humans,s=this.props,r=s.offsetW,o=s.offsetH,l=s.isMobile;if(null===n)return l?c.a.createElement("p",null,"Loading... "):c.a.createElement(h.a,{default:{x:r,y:o,width:a,height:t},lockAspectRatio:!0,onResize:this.onResize},c.a.createElement("p",null,"Loading..."));var p=[],g=0,f=0;return i.forEach((function(e){var a=t/512,n=d.a[g++];g===d.a.length&&(g=0),m.forEach((function(t){var i=e.keypoints[t[0]],s=e.keypoints[t[1]],r=[parseInt(i[0]*a),parseInt(i[1]*a),parseInt(s[0]*a),parseInt(s[1]*a)];p.push(c.a.createElement(u.Line,{key:f++,points:r,stroke:n}))}))})),l?c.a.createElement(u.Stage,{width:a,height:t},c.a.createElement(u.Layer,null,c.a.createElement(u.Image,{image:n,width:a,height:t}),p)):c.a.createElement(h.a,{default:{x:r,y:o,width:a,height:t},lockAspectRatio:!0,onResize:this.onResize},c.a.createElement(u.Stage,{width:a,height:t},c.a.createElement(u.Layer,null,c.a.createElement(u.Image,{image:n,width:a,height:t}),p)))}}]),a}(c.a.Component);t.a=p},381:function(e,t,a){e.exports=a(383)},383:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(17),r=a.n(s),o=a(146),l=a.n(o),c=(a(203),a(204),a(136)),h=a(53),u=a(68),d=a(61),m=a(4),p=a(5),g=a(7),f=a(6),v=a(416),b=a(250),y=Object(b.a)({palette:{primary:{main:"#ffffff"},secondary:{main:"#5f5f5f"}}}),k=a(418),M=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).handleClick=function(){n.state.isTimerOn?(n.setState({isTimerOn:!1,isSessionEnd:!0}),n.props.stateManager.socket.emit("terminateAgent",{turk_experiment_id:n.props.stateManager.getTurkExperimentId(),mephisto_agent_id:n.props.stateManager.getMephistoAgentId(),turk_worker_id:n.props.stateManager.getTurkWorkerId()})):(n.setState({isTimerOn:!0,startTime:Date.now()}),n.timer=setInterval((function(){n.setState({timeElapsed:Date.now()-n.state.startTime})}),10))},n.state={isTimerOn:!1,isSessionEnd:!1,startTime:0,timeElapsed:0},n}return Object(p.a)(a,[{key:"render",value:function(){var e=this.state.timeElapsed,t=("0"+Math.floor(e/1e3)%60).slice(-2),a=("0"+Math.floor(e/6e4)%60).slice(-2);return i.a.createElement(k.a,{theme:y},i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"content"},this.state.isSessionEnd?i.a.createElement("p",{style:{fontSize:40}},"Thanks for interacting with the bot. You may leave the page now."):i.a.createElement("div",null,i.a.createElement("div",{style:{fontSize:40}},a," : ",t),i.a.createElement("br",null),i.a.createElement(v.a,{className:"MsgButton",variant:"contained",color:this.state.isTimerOn?"secondary":"primary",onClick:this.handleClick.bind(this)},this.state.isTimerOn?"End":"Start"),i.a.createElement("br",null),i.a.createElement("p",null,"Please click on the button to start the session. "),i.a.createElement("p",null,"When you finished, click on the button to end the session and proceed to next steps.")))))}}]),a}(n.Component),E=a(13),w=a(43);a(181);window.React=i.a,window.ReactDOM=r.a;var x={settings:{showPopoutIcon:!1},content:[{type:"row",content:[{type:"column",content:[{type:"stack",content:[{title:"Interact",type:"react-component",component:"InteractApp",props:{stateManager:E.a}}]},{type:"stack",content:[{title:"Chat History",type:"react-component",component:"History",props:{stateManager:E.a}}]}]},{type:"column",content:[{type:"stack",content:[{title:"VoxelWorld",type:"react-component",component:"VoxelWorld",props:{stateManager:E.a}}],height:60},{type:"stack",content:[{title:"Info",type:"react-component",component:"TurkInfo",props:{stateManager:E.a}},{title:"Settings",type:"react-component",component:"Settings",props:{stateManager:E.a}}]}]}]}]},O=new l.a(x);O.registerComponent("MainPane",c.a),O.registerComponent("Settings",h.a),O.registerComponent("TurkInfo",M),O.registerComponent("History",u.a),O.registerComponent("VoxelWorld",d.a),O.registerComponent("InteractApp",w.a),O.init(),E.a.dashboardLayout=O},39:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(8),r=a(7),o=a(6),l=a(0),c=a.n(l),h=a(12),u=a(191),d=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).initialState={height:400,width:600,isLoaded:!1,memory:null,xmin:-10,xmax:10,ymin:-10,ymax:10,bot_xyz:[0,0,0],tooltip:null},i.state=i.initialState,i.outer_div=c.a.createRef(),i.resizeHandler=i.resizeHandler.bind(Object(s.a)(i)),i}return Object(i.a)(a,[{key:"resizeHandler",value:function(){if(this.props.isMobile){var e=this.props.dimensions;(void 0!==e&&e!==this.state.height||void 0!==e&&e!==this.state.width)&&this.setState({height:e,width:e})}else if(null!=this.outer_div&&null!=this.outer_div.current){var t=this.outer_div.current,a=t.clientHeight,n=t.clientWidth;(void 0!==a&&a!==this.state.height||void 0!==n&&n!==this.state.width)&&this.setState({height:a,width:n})}}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this),void 0!==this.props.glContainer&&this.props.glContainer.on("resize",this.resizeHandler)}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.bot_xyz,n=this.state,i=n.xmin,s=n.xmax,r=n.ymin,o=n.ymax,l=a[0],c=a[1],h=!1;l<i&&(i=l,h=!0),l>s&&(s=l,h=!0),c<r&&(r=c,h=!0),c>o&&(o=c,h=!0),h&&this.setState({xmin:i,ymin:r,xmax:s,ymax:o}),this.resizeHandler()}},{key:"componentWillUnmount",value:function(){this.props.stateManager&&this.props.stateManager.disconnect(this)}},{key:"render",value:function(){var e=this;if(!this.state.isLoaded)return c.a.createElement("p",null,"Loading");var t=this.state,a=t.height,n=t.width,i=t.memory,s=t.bot_xyz,r=t.obstacle_map,o=t.tooltip,l=i.objects,d=this.state,m=d.xmin,p=d.xmax,g=d.ymin,f=d.ymax,v=s[1],b=-s[0],y=s[2];if(0===a&&0===n)return c.a.createElement("div",{ref:this.outer_div,style:{height:"100%",width:"100%"}});v=parseInt((v-m)/(p-m)*n),b=parseInt((b-g)/(f-g)*a),b=a-b;var k=[],M=[],E=0;r&&r.forEach((function(e){var t=parseInt((e[0]-m)/(p-m)*n),i=parseInt((e[1]-g)/(f-g)*a);M.push(c.a.createElement(h.Circle,{key:E++,radius:2,x:t,y:i,fill:"#827f7f"}))})),l.forEach((function(t,i,s){var r,o=u.a[Math.abs((r=t.label,r.split("").reduce((function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e}),0)))%10],l=t.xyz,d=parseInt((l[2]-m)/(p-m)*n),v=parseInt((-l[0]-g)/(f-g)*a);v=a-v,k.push(c.a.createElement(h.Circle,{key:E++,radius:3,x:d,y:v,fill:o,onMouseEnter:function(a){e.setState({tooltip:JSON.stringify(t,null,4)}),a.currentTarget.setRadius(6)},onMouseLeave:function(t){e.setState({tooltip:null}),t.currentTarget.setRadius(3)}}))})),k.push(c.a.createElement(h.Circle,{key:E++,radius:10,x:v,y:b,fill:"red"})),k.push(c.a.createElement(h.Line,{key:E++,x:v,y:b,points:[0,0,12,0],rotation:180*-y/Math.PI,stroke:"black"}));for(var w=[],x=0;x<n/10;x++)w.push(c.a.createElement(h.Line,{key:12344+x,points:[Math.round(10*x)+.5,0,Math.round(10*x)+.5,a],stroke:"#f5f5f5",strokeWidth:1}));for(w.push(c.a.createElement(h.Line,{key:12344+x++,points:[0,0,10,10]})),E=0;E<a/10;E++)w.push(c.a.createElement(h.Line,{key:12344+x+E,points:[0,Math.round(10*E),n,Math.round(10*E)],stroke:"#ddd",strokeWidth:.5}));return c.a.createElement("div",{ref:this.outer_div,style:{height:"100%",width:"100%"}},c.a.createElement(h.Stage,{className:"memory2d",width:n,height:a},c.a.createElement(h.Layer,{className:"gridLayer"},w),c.a.createElement(h.Layer,{className:"mapBoundary"},M),c.a.createElement(h.Layer,{className:"renderedObjects"},k),c.a.createElement(h.Layer,null,c.a.createElement(h.Text,{text:o,offsetX:-12,offsetY:-12,visible:null!=o,shadowEnabled:!0}))))}}]),a}(c.a.Component);t.a=d},43:function(e,t,a){"use strict";var n=a(44),i=a(4),s=a(5),r=a(8),o=a(7),l=a(6),c=a(0),h=a.n(c),u=(a(127),a(416)),d=a(190),m=a(188),p=a(415),g=a(189),f=a(116),v=a.n(f),b=(a(128),new window.webkitSpeechRecognition);b.lang="en-US";var y=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={recognizing:!1},n.toggleListen=n.toggleListen.bind(Object(r.a)(n)),n.listen=n.listen.bind(Object(r.a)(n)),n.elementRef=h.a.createRef(),n.bindKeyPress=n.handleKeyPress.bind(Object(r.a)(n)),n}return Object(s.a)(a,[{key:"renderChatHistory",value:function(e){var t=this;return this.props.chats.map((function(a,n){return h.a.cloneElement(h.a.createElement(m.a,null,h.a.createElement(g.a,null,a.msg+(a.msg?"Sent successfully"===e?" \u2705":" \u274c":"")),h.a.createElement(p.a,null,""!==a.msg?h.a.createElement(u.a,{style:{backgroundColor:"red",color:"white"},onClick:function(){return t.props.goToQuestion(n)}},"Mark Error"):null)),{key:n.toString()})}))}},{key:"isMounted",value:function(){return null!=this.elementRef.current}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.handleSubmit())}},{key:"componentDidMount",value:function(){document.addEventListener("keypress",this.bindKeyPress)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keypress",this.bindKeyPress)}},{key:"toggleListen",value:function(){console.log("togglelisten"),this.setState({recognizing:!this.state.recognizing},this.listen)}},{key:"listen",value:function(){this.state.recognizing?b.start():b.stop(),b.onresult=function(e){for(var t="",a=0;a<e.results.length;++a)e.results[a].isFinal&&(t+=e.results[a][0].transcript);document.getElementById("msg").innerHTML=t},b.onerror=function(e){console.log("Error in recognition: "+e.error)}}},{key:"handleSubmit",value:function(){var e=document.getElementById("msg").innerHTML;""!==e.replace(/\s/g,"")&&(this.props.setInteractState({msg:e,failed:!1}),this.props.stateManager.socket.emit("sendCommandToAgent",e),document.getElementById("msg").innerHTML="")}},{key:"render",value:function(){return h.a.createElement("div",{className:"Chat"},h.a.createElement("p",null,"Enter the command to the bot in the input box below, or click the mic button to start/stop voice input."),h.a.createElement("p",null,"Click the x next to the message if the outcome wasn't as expected."),h.a.createElement(v.a,{className:"ASRButton",variant:"contained",color:this.state.recognizing?"default":"secondary",fontSize:"large",onClick:this.toggleListen.bind(this)}),h.a.createElement(d.a,null,this.renderChatHistory(this.props.status)),!0===this.props.isMobile?h.a.createElement("div",{style:{outline:" solid 1px black"},contentEditable:"true",className:"Msg single-line",id:"msg",suppressContentEditableWarning:!0}," "):h.a.createElement("div",{contentEditable:"true",className:"Msg single-line",id:"msg",suppressContentEditableWarning:!0}," "),h.a.createElement(u.a,{className:"MsgButton",variant:"contained",color:"primary",onClick:this.handleSubmit.bind(this)}," ","Submit"," "),h.a.createElement("p",{id:"assistantReply"},this.props.agent_reply," "))}}]),a}(c.Component),k=a(426),M=(a(130),function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={view:0,parsing_error:!1,action_dict:{},feedback:""},n}return Object(s.a)(a,[{key:"finishQuestions",value:function(){var e={action_dict:this.state.action_dict,parsing_error:this.state.parsing_error,msg:this.props.chats[this.props.failidx].msg,feedback:this.state.feedback};this.props.stateManager.socket.emit("saveErrorDetailsToCSV",e),this.props.goToMessage()}},{key:"saveFeedback",value:function(e){this.setState({feedback:e.target.value})}},{key:"renderParsingFail",value:function(){return h.a.createElement("div",null,h.a.createElement("h3",null," ","Thanks for letting me know that I didn't understand the command right."," "),h.a.createElement(u.a,{variant:"contained",color:"primary",onClick:this.finishQuestions.bind(this)},"Done"))}},{key:"renderParsingSuccess",value:function(){var e=this;return h.a.createElement("div",null,h.a.createElement("h3",null," ","Okay, looks like I understood your command but couldn't follow it all the way through. Tell me more about what I did wrong :"," "),h.a.createElement(k.a,{style:{backgroundColor:"white"},id:"outlined-uncontrolled",label:"",margin:"normal",variant:"outlined",onChange:function(t){return e.saveFeedback(t)}}),h.a.createElement("div",null),h.a.createElement(u.a,{variant:"contained",color:"primary",onClick:this.finishQuestions.bind(this)},"Done"))}},{key:"renderEnd",value:function(){var e=this;return h.a.createElement("div",null,h.a.createElement("h3",null," Thanks! Submit any other feedback here: "),h.a.createElement(k.a,{style:{backgroundColor:"white"},id:"outlined-uncontrolled",label:"",margin:"normal",variant:"outlined",onChange:function(t){return e.saveFeedback(t)}}),h.a.createElement("div",null),h.a.createElement(u.a,{variant:"contained",color:"primary",onClick:this.finishQuestions.bind(this)},"Done"))}},{key:"renderSemanticParserErrorQuestion",value:function(){var e=this;if(this.state.action_dict)if("dialogue_type"in this.state.action_dict){var t=this.state.action_dict.dialogue_type,a="";if("HUMAN_GIVE_COMMAND"===t){var n=this.state.action_dict.action_sequence[0],i=n.action_type.toLowerCase();a="to "+i+" ",["build","dig"].indexOf(i)>=0?("schematic"in n&&(a=a+"'"+n.schematic.text_span+"'"),"location"in n&&(a=a+" at location '"+n.location.text_span+"'"),a+=" ?"):["destroy","fill","spawn","copy","get","scout"].indexOf(i)>=0?("reference_object"in n&&(a=a+"'"+n.reference_object.text_span+"'"),"location"in n&&(a=a+" at location '"+n.location.text_span+"'"),a+=" ?"):["move"].indexOf(i)>=0?("location"in n&&(a=a+" at location '"+n.location.text_span+"'"),a+=" ?"):["stop","resume","undo"].indexOf(i)>=0&&("target_action_type"in n&&(a=a+" at location '"+n.target_action_type+"'"),a+=" ?")}else"GET_MEMORY"===t?a="to answer a question about something in the Minecraft world ?":"PUT_MEMORY"===t?a="to remember or learn something you taught it ?":"NOOP"===t&&(a="to do nothing ?")}else a="did you want me to do nothing ?";return h.a.createElement("div",{className:"question"},h.a.createElement("h5",null,"Did you want the assistant ",a),h.a.createElement(d.a,{className:"answers",component:"nav"},h.a.createElement(m.a,{button:!0,onClick:function(){return e.answerParsing(1)}},h.a.createElement(g.a,{primary:"Yes"})),h.a.createElement(m.a,{button:!0,onClick:function(){return e.answerParsing(2)}},h.a.createElement(g.a,{primary:"No"}))))}},{key:"answerParsing",value:function(e){1===e?this.setState({view:2}):2===e&&this.setState({parsing_error:!0,view:1})}},{key:"goToEnd",value:function(e){this.setState({view:3,new_action_dict:e})}},{key:"componentDidMount",value:function(){var e=this.props.stateManager.memory.chatResponse,t=this.props.chats[this.props.failidx].msg;this.setState({action_dict:e[t]})}},{key:"render",value:function(){return h.a.createElement("div",null,h.a.createElement("div",{className:"msg-header"},"Message you sent to the bot: ",h.a.createElement("br",null),this.props.chats[this.props.failidx].msg),0===this.state.view?this.renderSemanticParserErrorQuestion():null,1===this.state.view?this.renderParsingFail():null,2===this.state.view?this.renderParsingSuccess():null,3===this.state.view?this.renderEnd():null)}}]),a}(c.Component)),E=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).initialState={currentView:1,chatResponse:"",status:"",chats:[{msg:"",failed:!1}],failidx:-1,agent_reply:""},n.state=n.initialState,n.setAssistantReply=n.setAssistantReply.bind(Object(r.a)(n)),n.MessageRef=h.a.createRef(),n}return Object(s.a)(a,[{key:"setInteractState",value:function(e){var t=Object(n.a)(this.state.chats);t.shift(),t.push(e),this.setState({chats:t})}},{key:"setAssistantReply",value:function(e){this.setState({agent_reply:e.agent_reply})}},{key:"componentDidMount",value:function(){this.props.stateManager&&(this.props.stateManager.connect(this),this.props.stateManager.socket.on("showAssistantReply",this.setAssistantReply))}},{key:"componentWillUnmount",value:function(){this.props.stateManager&&this.props.stateManager.disconnect(this)}},{key:"getUrlParameterByName",value:function(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}},{key:"goToMessage",value:function(){var e=this.state.chats;-1!==this.state.failidx&&(e[this.state.failidx].failed=!0),this.setState({currentView:1,chats:e})}},{key:"goToQuestion",value:function(e){this.setState({currentView:2,chats:this.state.chats,failidx:e})}},{key:"render",value:function(){return h.a.createElement("div",{className:"App"},h.a.createElement("div",{className:"content"},1===this.state.currentView?h.a.createElement(y,{status:this.state.status,stateManager:this.props.stateManager,isMobile:this.props.isMobile,ref:this.MessageRef,chats:this.state.chats,agent_reply:this.state.agent_reply,goToQuestion:this.goToQuestion.bind(this),setInteractState:this.setInteractState.bind(this)}):null,2===this.state.currentView?h.a.createElement(M,{stateManager:this.props.stateManager,chats:this.state.chats,failidx:this.state.failidx,goToMessage:this.goToMessage.bind(this),failmsg:this.state.chats[this.state.failidx].msg}):null))}}]),a}(c.Component);t.a=E},53:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(8),r=a(7),o=a(6),l=a(0),c=a.n(l),h=(a(175),a(91)),u=(a(176),{width:600,margin:50}),d={minWidth:"60px",display:"inline-block"},m=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).initialState={url:i.props.stateManager.url,fps:0,connected:!1,image_quality:-1,image_resolution:-1},i.props.isMobile&&(u={margin:50}),i.state=i.initialState,i.handleChange=i.handleChange.bind(Object(s.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(s.a)(i)),i.setImageSettings=i.setImageSettings.bind(Object(s.a)(i)),i.onImageQualityChange=i.onImageQualityChange.bind(Object(s.a)(i)),i.onImageResolutionChange=i.onImageResolutionChange.bind(Object(s.a)(i)),i}return Object(i.a)(a,[{key:"setImageSettings",value:function(e){this.setState(e)}},{key:"handleChange",value:function(e){this.setState({url:e.target.value})}},{key:"handleSubmit",value:function(e){this.props.stateManager.setUrl(this.state.url),e.preventDefault()}},{key:"handleClearSettings",value:function(e){this.props.stateManager.setDefaultUrl()}},{key:"componentDidMount",value:function(){this.props.stateManager&&(this.props.stateManager.connect(this),this.setState({connected:this.props.stateManager.connected}),this.props.stateManager.socket.on("image_settings",this.setImageSettings))}},{key:"componentWillUnmount",value:function(){this.props.stateManager&&(this.props.stateManager.disconnect(this),this.setState({connected:!1}),this.props.stateManager.socket.off("image_settings",this.setImageSettings))}},{key:"onImageQualityChange",value:function(e){!0===this.state.connected&&this.props.stateManager.socket.emit("update_image_settings",{image_quality:e,image_resolution:this.state.image_resolution})}},{key:"onImageResolutionChange",value:function(e){!0===this.state.connected&&this.props.stateManager.socket.emit("update_image_settings",{image_quality:this.state.image_quality,image_resolution:e})}},{key:"render",value:function(){var e;e=!0===this.state.connected?c.a.createElement("status-indicator",{positive:!0,pulse:!0}):c.a.createElement("status-indicator",{negative:!0,pulse:!0});var t=!1;return-1===this.state.image_quality&&(t=!0),c.a.createElement("div",null,c.a.createElement("form",{onSubmit:this.handleSubmit},c.a.createElement("label",null,"Server / Robot URL:",c.a.createElement("input",{type:"text",value:this.state.url,onChange:this.handleChange})),c.a.createElement("input",{type:"submit",value:"Reconnect"})),c.a.createElement("form",{onSubmit:this.handleClearSettings},c.a.createElement("input",{type:"submit",value:"Clear Saved Settings"})),c.a.createElement("p",null,"FPS: ",this.state.fps),c.a.createElement("p",null," Connection Status: ",e," "),c.a.createElement("div",{style:u},c.a.createElement("label",{style:d},"Image Quality: \xa0"),c.a.createElement("span",null,this.state.image_quality),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(h.a,{value:this.state.image_quality,min:1,max:100,step:1,onChange:this.onImageQualityChange,disabled:t})),c.a.createElement("div",{style:u},c.a.createElement("label",{style:d},"Image Resolution: \xa0"),c.a.createElement("span",null,this.state.image_resolution),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(h.a,{value:this.state.image_resolution,min:16,max:512,step:16,onChange:this.onImageResolutionChange,disabled:t})))}}]),a}(c.a.Component);t.a=m},57:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(7),r=a(6),o=a(0),l=a.n(o),c=a(44),h=a(8),u=(a(125),a(126),function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={selectedTags:e.tags||[],suggestions:[],currentValue:""},i.inputRef=l.a.createRef(),i}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"tag-selector"},l.a.createElement("div",{className:"tag-holder"},this.state.selectedTags.map((function(t,a){return l.a.createElement("span",{className:"tag-selected",key:a},t,l.a.createElement("button",{onClick:function(){e.removeTag(t)}},"X"))}))),l.a.createElement("input",{type:"text",placeholder:"Tags (press Enter to add)",ref:this.inputRef,onChange:this.update.bind(this),onKeyDown:this.keyDown.bind(this)}),l.a.createElement("div",{className:"tag-suggestions"},this.state.suggestions.map((function(t,a){return l.a.createElement("span",{kkey:a},l.a.createElement("button",{onClick:function(){e.addTag(t)}},a))}))))}},{key:"update",value:function(e){var t=this,a=this.inputRef.current.value;0!==a.length?this.setState({suggestions:this.props.tags.filter((function(e){return e.toLowerCase().slice(0,a.length)===a&&-1===t.state.selectedTags.indexOf(e)}))}):this.setState({suggestions:[]})}},{key:"removeTag",value:function(e){var t=this;this.setState({selectedTags:this.state.selectedTags.filter((function(t){return t!==e}))},(function(){t.props.update(t.state.selectedTags)}))}},{key:"addTag",value:function(e){var t=this;e=e.toLowerCase(),this.setState({selectedTags:this.state.selectedTags.concat(e),suggestions:[]},(function(){t.props.update(t.state.selectedTags)})),this.inputRef.current.value=""}},{key:"keyDown",value:function(e){"Enter"===e.key&&""!==this.inputRef.current.value.trim()&&this.addTag(this.inputRef.current.value),this.setState({currentValue:this.inputRef.current.value})}}]),a}(l.a.Component)),d=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).tags=i.props.tags||[],i.submit=i.submit.bind(Object(h.a)(i)),i.nameRef=l.a.createRef(),i}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return this.props.isMobile?l.a.createElement("div",{className:"data-entry-root data-entry-block-mobile"},l.a.createElement("input",{placeholder:"Object Name",ref:this.nameRef}),l.a.createElement(u,{tags:this.labels,update:function(t){return e.tags=t}}),l.a.createElement("button",{className:"data-entry-submit",onClick:this.submit.bind(this)},"Submit")):l.a.createElement("div",{className:"data-entry-root",style:{top:this.props.y+"px",left:this.props.x+"px",position:"fixed"}},l.a.createElement("input",{placeholder:"Object Name",ref:this.nameRef,defaultValue:this.props.label||""}),l.a.createElement(u,{tags:this.tags,update:function(t){return e.tags=t}}),this.props.includeSubmitButton?l.a.createElement("button",{className:"data-entry-submit",onClick:this.submit},"Submit"):null,this.props.deleteCallback?l.a.createElement("button",{className:"data-entry-delete",onClick:this.props.deleteCallback},"Delete object (\u232b)"):null)}},{key:"submit",value:function(){var e=this.nameRef.current.value.trim();0!==e.length?this.tags.length<2?alert("Please enter at least 2 descriptive tags for the object. Examples include: color, shape, size, orientation, etc."):this.props.onSubmit({name:e.toLowerCase(),tags:this.tags}):alert("You must enter the object's name")}}]),a}(l.a.Component),m=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={message:""},i.update=i.update.bind(Object(h.a)(i)),i.drawPointsAndLines=i.drawPointsAndLines.bind(Object(h.a)(i)),i.onClick=i.onClick.bind(Object(h.a)(i)),i.addHandler=i.addHandler.bind(Object(h.a)(i)),i.addMaskHandler=i.addMaskHandler.bind(Object(h.a)(i)),i.addPointHandler=i.addPointHandler.bind(Object(h.a)(i)),i.deleteHandler=i.deleteHandler.bind(Object(h.a)(i)),i.deleteMaskHandler=i.deleteMaskHandler.bind(Object(h.a)(i)),i.deletePointHandler=i.deletePointHandler.bind(Object(h.a)(i)),i.changeTextHandler=i.changeTextHandler.bind(Object(h.a)(i)),i.zoomIn=i.zoomIn.bind(Object(h.a)(i)),i.zoomOut=i.zoomOut.bind(Object(h.a)(i)),i.onMouseMove=i.onMouseMove.bind(Object(h.a)(i)),i.keyDown=i.keyDown.bind(Object(h.a)(i)),i.drawPoint=i.drawPoint.bind(Object(h.a)(i)),i.drawLine=i.drawLine.bind(Object(h.a)(i)),i.localToImage=i.localToImage.bind(Object(h.a)(i)),i.imageToLocal=i.imageToLocal.bind(Object(h.a)(i)),i.shiftViewBy=i.shiftViewBy.bind(Object(h.a)(i)),i.mode=i.props.mode||"default",i.prevMode="default",i.baseMode="default",i.message="",i.currentMaskId=0,i.isDrawingPolygon=!1,i.lastMouse={x:0,y:0},i.points=[[]],i.regions=[],i.newMask="drawing"===i.props.mode,i.canvasRef=l.a.createRef(),i.dataEntryRef=l.a.createRef(),i.zoomPixels=300,i.zoomed=!1,i.pointSize=10,i.color=i.props.color,i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.canvas=this.canvasRef.current,this.ctx=this.canvas.getContext("2d"),this.points=this.props.masks?this.props.masks.map((function(t){return t.map((function(t){return{x:t.x*e.canvas.width,y:t.y*e.canvas.height}}))})).filter((function(e){return e})):[[]],this.img=this.props.img,this.Offset={x:0,y:0},this.baseScale=Math.min(this.canvas.width/this.img.width,this.canvas.height/this.img.height),this.scale=this.baseScale,this.update()}},{key:"render",value:function(){var e=this,t="500px";this.props.imageWidth&&(t=this.props.imageWidth);var a=this.canvas&&this.canvas.getBoundingClientRect().right,n=this.canvas&&this.canvas.getBoundingClientRect().top+this.canvas.height/3;return l.a.createElement("div",null,l.a.createElement("p",null,this.state.message),l.a.createElement("div",null,l.a.createElement("button",{onClick:this.addHandler},l.a.createElement("span",{role:"img","aria-label":"Plus"},"\u2795")," ","(a)"),l.a.createElement("button",{onClick:this.deleteHandler},l.a.createElement("span",{role:"img","aria-label":"Trash"},"\ud83d\uddd1\ufe0f")," ","(d)"),l.a.createElement("button",{onClick:this.zoomIn},l.a.createElement("span",{role:"img","aria-label":"Magnifying Glass Right"},"\ud83d\udd0e")," ","(=)"),l.a.createElement("button",{onClick:this.zoomOut},l.a.createElement("span",{role:"img","aria-label":"Magnifying Glass Left"},"\ud83d\udd0d")," ","(-)"),l.a.createElement("button",{onClick:this.dataEntryRef.current&&this.dataEntryRef.current.submit},l.a.createElement("span",{role:"img","aria-label":"Save"},"\ud83d\udcbe")," ","(\u21b5)")),l.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},l.a.createElement("canvas",{ref:this.canvasRef,width:t,height:t,tabIndex:"0",onClick:this.onClick,onMouseMove:this.onMouseMove,onKeyDown:this.keyDown}),this.props.isMobile&&l.a.createElement("button",{onClick:this.pressEnterOnMobile.bind(this)},"Finished with ",this.props.object,"'s label"),l.a.createElement("div",null,l.a.createElement(d,{ref:this.dataEntryRef,x:a,y:n,onSubmit:this.changeTextHandler,label:this.props.object,tags:this.props.tags,deleteCallback:function(){return e.props.deleteLabelHandler()}}))))}},{key:"update",value:function(){this.resetImage(this.zoomed),this.updateMessage();var e=["dragging","focus"].includes(this.mode);this.drawPointsAndLines(e),this.drawRegions(e),"Enter"===this.lastKey&&this.points[this.currentMaskId]&&this.points[this.currentMaskId].length>=3&&(this.zoomed=!1,this.resetImage(this.zoomed),this.drawPointsAndLines(),this.drawRegions())}},{key:"onClick",value:function(e){if("dragging"===this.mode){var t=this.prevMode;return this.prevMode=this.mode,this.mode=t,void this.update()}var a=this.getPointClick();if(null!=a){if("adding"===this.mode&&this.addPointHandler(),"deleting"===this.mode&&this.deletePointHandler(),["addingMask"].includes(this.mode)&&a[0]!==this.currentMaskId)return;if("addingPoint"===this.mode){var n=this.points[a[0]].slice();n.splice(a[1],0,n[a[1]]),this.points[a[0]]=n}return"deletingPoint"===this.mode&&this.points[a[0]].length>3?(this.points[a[0]].length>3&&this.points[a[0]].splice(a[1],1),void this.update()):(this.prevMode=this.mode,this.mode="dragging",this.draggingIndex=a,this.currentMaskId=a[0],void this.update())}if("adding"===this.mode&&this.addMaskHandler(),["drawing","addingMask"].includes(this.mode)&&("Enter"!==this.lastKey||["drawing","addingMask"].includes(this.prevMode)||this.points[this.currentMaskId]&&this.points[this.currentMaskId].length<3))return this.points[this.currentMaskId].push(this.localToImage(this.lastMouse)),this.updateZoom(),this.update(),void(this.lastKey="Mouse");var i=this.getRegionClick();if("default"!==this.mode){if("focus"===this.mode)return-1===i&&(this.prevMode=this.mode,this.mode="default",this.currentMaskId=-1),this.update(),void(this.lastKey="Mouse");if(["deletingMask","deleting"].includes(this.mode)){if(-1===i)return;return"deleting"===this.mode&&this.deleteMaskHandler(),1===this.points.length&&this.props.deleteLabelHandler(),this.points.splice(i,1),this.update(),void(this.lastKey="Mouse")}}else-1!==i&&(this.prevMode=this.mode,this.mode="focus",this.currentMaskId=i,this.update(),this.lastKey="Mouse")}},{key:"keyDown",value:function(e){switch(e.key){case" ":this.points[this.currentMaskId].length>0&&this.points[this.currentMaskId].pop(),this.update();break;case"a":this.addHandler();break;case"s":this.addMaskHandler();break;case"q":this.addPointHandler();break;case"d":this.deleteHandler();break;case"f":this.deleteMaskHandler();break;case"e":this.deletePointHandler();break;case"Backspace":this.props.deleteLabelHandler();break;case"Enter":"Enter"===this.lastKey&&this.points[this.currentMaskId]&&this.points[this.currentMaskId].length>=3&&(this.lastKey=null,this.baseMode="default",this.prevMode=this.mode,this.mode="default",this.save()),["adding","addingMask","addingPoint","deleting","deletingMask","deletingPoint"].includes(this.mode)&&this.points[this.currentMaskId]&&this.points[this.currentMaskId].length>=3&&(this.baseMode="default",this.prevMode=this.mode,this.mode="default");break;case"Escape":if(this.points[this.currentMaskId]){if(this.points[this.currentMaskId].length>=3)return this.save(),this.mode="default",void this.props.exitCallback();if(1===this.points.length)return void this.props.deleteLabelHandler();this.points.splice(this.currentMaskId,1),this.currentMaskId=0,this.prevMode=this.mode,this.mode="default"}break;case"=":this.zoomIn(),this.update();break;case"-":this.zoomOut(),this.update()}this.lastKey=e.key}},{key:"addHandler",value:function(){this.baseMode="default",this.prevMode=this.mode,this.mode="adding"}},{key:"addMaskHandler",value:function(){!this.points[this.currentMaskId]||this.points[this.currentMaskId].length<3||(this.currentMaskId=this.points.length,this.points.push([]),this.prevMode=this.mode,this.mode="addingMask")}},{key:"addPointHandler",value:function(){this.baseMode=this.points[this.currentMaskId]&&0===this.points[this.currentMaskId].length?"default":this.mode,this.prevMode=this.mode,this.mode="addingPoint"}},{key:"deleteHandler",value:function(){this.baseMode="default",this.prevMode=this.mode,this.mode="deleting"}},{key:"deleteMaskHandler",value:function(){!this.points[this.currentMaskId]||this.points[this.currentMaskId].length<3||(this.prevMode=this.mode,this.mode="deletingMask")}},{key:"deletePointHandler",value:function(){this.baseMode=["drawing","addingMask"].includes(this.mode)?this.mode:"default",this.prevMode=this.mode,this.mode="deletingPoint"}},{key:"changeTextHandler",value:function(e){!this.points[this.currentMaskId]||this.points[this.currentMaskId].length<3||(this.save(),this.props.dataEntrySubmit(e))}},{key:"zoomIn",value:function(){this.zoomPixels-=10,this.updateZoom()}},{key:"zoomOut",value:function(){this.zoomPixels+=10,this.updateZoom()}},{key:"updateMessage",value:function(){var e="";switch(this.mode){case"adding":e="Click a point to duplicate it (q) or click anywhere else to create a new mask for this object (s)";break;case"addingMask":e="Create a new mask for this object";break;case"addingPoint":e="Click a point to duplicate it and place it where you want";break;case"deleting":e="Click a point to delete it (e) or click a mask to delete it (f)";break;case"deletingMask":e="Select which mask to delete";break;case"deletingPoint":e="Select a point to delete";break;default:e="Please trace the "+(this.props.object||"object")}e!==this.state.message&&this.setState({message:e})}},{key:"updateZoom",value:function(){if(this.zoomed=!0,this.scale=Math.min(this.canvas.width/this.zoomPixels,this.canvas.height/this.zoomPixels),-1!==this.currentMaskId&&this.points[this.currentMaskId]&&0!==this.points[this.currentMaskId].length&&["default","dragging","drawing","addingMask"].includes(this.mode)){var e=this.points[this.currentMaskId];this.Offset={x:-(e[e.length-1].x-this.zoomPixels/2)*this.scale,y:-(e[e.length-1].y-this.zoomPixels/2)*this.scale}}}},{key:"onMouseMove",value:function(e){var t=this.canvas.getBoundingClientRect();this.lastMouse={x:e.clientX-t.left,y:e.clientY-t.top+1},"dragging"===this.mode&&(this.points[this.draggingIndex[0]][this.draggingIndex[1]]=this.localToImage(this.lastMouse)),this.update()}},{key:"pressEnterOnMobile",value:function(){this.lastKey=null,this.props.submitCallback(this.points)}},{key:"save",value:function(){var e=this;this.props.submitCallback(this.points.map((function(t){return t.map((function(t){return{x:t.x/e.canvas.width,y:t.y/e.canvas.height}}))})),this.newMask)}},{key:"getPointClick",value:function(){for(var e=0;e<this.points.length;e++)for(var t=0;t<this.points[e].length;t++)if(this.distance(this.points[e][t],this.localToImage(this.lastMouse))<this.pointSize/2)return[e,t];return null}},{key:"getRegionClick",value:function(){for(var e=-1,t=0;t<this.regions.length;t++)this.regions[t]&&this.ctx.isPointInPath(this.regions[t],this.lastMouse.x,this.lastMouse.y)&&(e=t);return e}},{key:"drawPointsAndLines",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;t<this.points.length;t++)if((!0!==e||t===this.currentMaskId)&&this.points[t]&&0!==this.points[t].length){for(var a=0;a<this.points[t].length-1;a++)this.drawLine(this.points[t][a],this.points[t][a+1]),this.drawPoint(this.points[t][a]);this.drawPoint(this.points[t][this.points[t].length-1]),["drawing","addingMask"].includes(this.mode)||["drawing","addingMask"].includes(this.prevMode)||this.drawLine(this.points[t][0],this.points[t][this.points[t].length-1])}this.points[this.currentMaskId]&&this.points[this.currentMaskId].length>0&&["drawing","addingMask"].includes(this.mode)&&this.drawLine(this.points[this.currentMaskId][this.points[this.currentMaskId].length-1],this.localToImage(this.lastMouse))}},{key:"drawRegions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.regions=[];for(var t=0;t<this.points.length;t++)if(!e||t===this.currentMaskId){var a=this.drawRegion(this.points[t]);this.regions.push(a)}}},{key:"drawPoint",value:function(e){this.ctx.fillStyle="black",this.distance(e,this.localToImage(this.lastMouse))<this.pointSize/2&&(this.ctx.fillStyle="green"),this.ctx.fillRect(e.x-2.5,e.y-2.5,5,5)}},{key:"drawLine",value:function(e,t){this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.x,t.y),this.ctx.stroke()}},{key:"drawRegion",value:function(e){if(e&&!(e.length<3)){var t=new Path2D;t.moveTo(e[0].x,e[0].y);for(var a=1;a<e.length;a++)t.lineTo(e[a].x,e[a].y);return t.closePath(),this.ctx.fillStyle=this.color,this.ctx.fill(t,"evenodd"),t}}},{key:"localToImage",value:function(e){var t,a;return this.zoomed?(t=(e.x-this.Offset.x)/this.scale,a=(e.y-this.Offset.y)/this.scale):(t=e.x/this.baseScale,a=e.y/this.baseScale),{x:Math.min(Math.max(t,0),512),y:Math.min(Math.max(a,0),512)}}},{key:"imageToLocal",value:function(e){var t=this.zoomed?this.scale:this.baseScale,a=this.zoomed?this.Offset.x:0,n=this.zoomed?this.Offset.y:0;return{x:e.x*t+a,y:e.y*t+n}}},{key:"resetView",value:function(){this.Offset={x:0,y:0},this.scale=Math.min(this.canvas.width/this.img.width,this.canvas.height/this.img.height)}},{key:"resetImage",value:function(e){this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),e?this.ctx.setTransform(this.scale,0,0,this.scale,this.Offset.x,this.Offset.y):(this.ctx.setTransform(this.baseScale,0,0,this.baseScale,0,0),this.zoomed=!1),this.ctx.drawImage(this.img,0,0)}},{key:"shiftViewBy",value:function(e,t){this.Offset={x:this.Offset.x+e,y:this.Offset.y+t}}},{key:"distance",value:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}},{key:"distanceToSegment",value:function(e,t,a){var n=this.distance(t,a);if(0===n)return this.distance(e,t);var i=((e.x-t.x)*(a.x-t.x)+(e.y-t.y)*(a.y-t.y))/n;i=Math.max(0,Math.min(1,i));var s={x:t.x+i*(a.x-t.x),y:t.y+i*(a.y-t.y)};return this.distance(e,s)}}]),a}(l.a.Component),p=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).update=i.update.bind(Object(h.a)(i)),i.drawLine=i.drawLine.bind(Object(h.a)(i)),i.onClick=i.onClick.bind(Object(h.a)(i)),i.regions={},i.canvasRef=l.a.createRef(),i.imgRef=l.a.createRef(),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.canvas=this.canvasRef.current,this.ctx=this.canvas.getContext("2d"),this.Offset={x:0,y:0},this.baseScale=this.canvas.width/this.props.img.width,this.scale=this.baseScale,this.canvas.height=this.props.img.height*this.baseScale,this.update()}},{key:"render",value:function(){var e="500px";return this.props.imageWidth&&(e=this.props.imageWidth),l.a.createElement("div",null,l.a.createElement("canvas",{ref:this.canvasRef,width:e,height:e,tabIndex:"0",onMouseMove:this.onMouseMove,onKeyDown:this.keyDown}))}},{key:"update",value:function(){var e=this;this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.setTransform(this.scale,0,0,this.scale,this.Offset.x,this.Offset.y),this.ctx.drawImage(this.props.img,0,0);for(var t=0;t<this.props.objects.length;t++){var a=this.props.objects[t],n=this.props.pointMap[a];if(0!==n.length){this.regions[a]=[];var i=this.props.colors[t%this.props.colors.length]||"rgba(0,200,0,.5)";for(var s in n){var r=n[s].map((function(t){return{x:t.x*e.canvas.width,y:t.y*e.canvas.height}})),o=this.drawRegion(r,i);this.regions[a].push(o)}}}this.canvas.addEventListener("mousedown",this.onClick)}},{key:"onClick",value:function(e){var t=-1;for(var a in this.regions)for(var n in this.regions[a])this.regions[a][n]&&this.ctx.isPointInPath(this.regions[a][n],e.offsetX,e.offsetY)&&(t=a);var i=-1!==t;this.props.onClick(e.clientX,e.clientY,i,t)}},{key:"drawLine",value:function(e,t){this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.x,t.y),this.ctx.stroke()}},{key:"drawRegion",value:function(e,t){if(!(e.length<3)){var a=new Path2D;a.moveTo(e[0].x,e[0].y);for(var n=1;n<e.length;n++)a.lineTo(e[n].x,e[n].y);return a.closePath(),this.ctx.fillStyle=t,this.ctx.fill(a,"evenodd"),a}}},{key:"getCanvasBoundingBox",value:function(){return this.canvas.getBoundingClientRect()}}]),a}(l.a.Component),g=["rgba(0,200,0,.5)","rgba(200,0,0,.5)","rgba(0,100,255,.5)","rgba(255,150,0,.5)","rgba(100,255,200,.5)","rgba(200,200,0,.5)","rgba(0,200,150,.5)","rgba(200,0,200,.5)","rgba(0,204,255,.5)"],f=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;Object(n.a)(this,a),(i=t.call(this,e)).state={objectIds:Object(c.a)(Array(i.props.objects.length).keys()),currentMode:"select",currentOverlay:null,currentMaskId:null},i.nextId=i.props.objects.length,i.nameMap={},i.pointMap={},i.propertyMap={};for(var s=0;s<i.props.objects.length;s++){var r=i.props.objects[s];i.nameMap[s]=r.label,i.pointMap[s]=r.mask,i.parsePoints(s),i.propertyMap[s]=r.properties}return i.registerClick=i.registerClick.bind(Object(h.a)(i)),void 0!==i.props.image?i.image=i.props.image:(i.image=new Image,i.image.onload=function(){i.forceUpdate()},i.image.src=i.props.imgUrl),i.segRef=l.a.createRef(),i.overtime=!1,setInterval((function(){i.overtime=!0}),6e4*window.MINUTES),i}return Object(i.a)(a,[{key:"render",value:function(){var e=this;if(["draw_polygon","start_polygon"].includes(this.state.currentMode)){var t=this.state.objectIds.indexOf(parseInt(this.state.currentMaskId)),a=t>=0?g[t%g.length]:g[this.state.objectIds.length%g.length];return l.a.createElement(m,{img:this.image,object:this.drawing_data.name,tags:this.drawing_data.tags,masks:this.pointMap[this.state.currentMaskId],color:a,exitCallback:function(){e.setState({currentMode:"select"})},submitCallback:this.drawingFinished.bind(this),deleteLabelHandler:this.deleteLabelHandler.bind(this),dataEntrySubmit:this.dataEntrySubmit.bind(this),mode:"start_polygon"===this.state.currentMode?"drawing":null})}return l.a.createElement("div",null,l.a.createElement("p",null,"Label and outline as ",l.a.createElement("b",null,"many objects as possible.")," Click an object in the image to start. ",this.state.objectIds.length," ","object(s) labeled."),this.state.currentOverlay,l.a.createElement("button",{onClick:function(){return e.newPolygon.bind(e)()}},"New Label"),l.a.createElement("div",null,this.state.objectIds.map((function(t,a){return l.a.createElement("button",{key:t,style:{backgroundColor:e.fullColor(g[a%g.length])},onClick:function(){return e.labelSelectHandler(t)}},e.nameMap[t])}))),l.a.createElement(p,{ref:this.segRef,img:this.image,objects:this.state.objectIds,pointMap:this.pointMap,colors:g,imageWidth:this.props.imageWidth,onClick:this.registerClick}),l.a.createElement("button",{onClick:this.submit.bind(this)},"Finished annotating objects"))}},{key:"parsePoints",value:function(e){for(var t in this.pointMap[e])if(this.pointMap[e][t].length<3)delete this.pointMap[e][t];else{var a=0,n=1,i=0,s=1;for(var r in this.pointMap[e][t]){var o=this.pointMap[e][t][r];a=Math.max(o.x,a),n=Math.min(o.x,n),i=Math.max(o.y,i),s=Math.min(o.y,s)}var l=a-n+i-s,c=l<.015?3:50*l;if(this.pointMap[e][t].length>c){for(var h=[],u=this.pointMap[e][t].length/c,d=0;d<this.pointMap[e][t].length-1;d+=u)h.push(this.pointMap[e][t][parseInt(d)]);this.pointMap[e][t]=h}}}},{key:"drawingFinished",value:function(e,t){if(this.pointMap[this.state.currentMaskId]=e,this.setState({currentMode:"select",objectIds:t?this.state.objectIds.splice(0).concat(this.state.currentMaskId):this.state.objectIds}),t){var a=l.a.createElement(d,{x:this.clickPoint.x,y:this.clickPoint.y,onSubmit:this.dataEntrySubmit.bind(this),includeSubmitButton:!0,isMobile:this.props.isMobile});this.setState({currentMode:"fill_data",currentOverlay:a})}}},{key:"deleteLabelHandler",value:function(){delete this.nameMap[this.state.currentMaskId],delete this.pointMap[this.state.currentMaskId],delete this.propertyMap[this.state.currentMaskId];var e=this.state.objectIds.slice(),t=this.state.objectIds.indexOf(parseInt(this.state.currentMaskId));t>=0&&e.splice(t,1),this.setState({currentMode:"select",currentMaskId:-1,objectIds:e})}},{key:"dataEntrySubmit",value:function(e){this.drawing_data=e,this.propertyMap[this.state.currentMaskId]=this.drawing_data.tags,this.nameMap[this.state.currentMaskId]=this.drawing_data.name,this.setState({currentMode:"select",currentOverlay:null})}},{key:"labelSelectHandler",value:function(e){this.setState({currentMode:"draw_polygon",currentOverlay:null,currentMaskId:e}),this.drawing_data={tags:this.propertyMap[e],name:this.nameMap[e]}}},{key:"registerClick",value:function(e,t,a,n){"select"===this.state.currentMode&&(a?(this.drawing_data={tags:this.propertyMap[n],name:this.nameMap[n]},this.setState({currentMode:"draw_polygon",currentOverlay:null,currentMaskId:n})):"fill_data"!==this.state.currentMode&&this.newPolygon(e,t))}},{key:"newPolygon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(this.drawing_data={tags:null,name:null},this.setState({currentMode:"start_polygon",currentMaskId:this.nextId}),-1===e){var a=this.segRef.current.getCanvasBoundingBox();e=a.left,t=a.top}this.clickPoint={x:e,y:t},this.nextId+=1}},{key:"fullColor",value:function(e){return e.substring(0,e.length-3)+"1)"}},{key:"submit",value:function(){if(this.state.objectIds.length<window.MIN_OBJECTS)alert("Label more objects, or your HIT may be rejected");else{var e={nameMap:this.nameMap,propertyMap:this.propertyMap,pointMap:this.pointMap};this.props.stateManager.socket.emit("saveObjectAnnotation",e),this.props.not_turk}}}]),a}(l.a.Component),v=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).props.image?i.initialState={image:i.props.image}:i.initialState={image:void 0},i.state=i.initialState,i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this)}},{key:"render",value:function(){return void 0===this.state.image?null:l.a.createElement(f,{image:this.state.image,objects:this.state.objects,not_turk:!0,stateManager:this.props.stateManager,isMobile:this.props.isMobile,imageWidth:this.props.imageWidth})}}]),a}(l.a.Component);t.a=v},61:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(7),r=a(6),o=a(0),l=a.n(o),c=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={status:"",world_state:{}},i.worldContainerRef=l.a.createRef(),i}return Object(i.a)(a,[{key:"getVoxelWorldInitialState",value:function(){this.props.stateManager.socket.emit("getVoxelWorldInitialState")}},{key:"componentDidUpdate",value:function(){this.worldContainerRef.current.contentWindow.postMessage(this.state,"*")}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this),this.getVoxelWorldInitialState()}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{id:"world-container"},l.a.createElement("iframe",{id:"ifr",src:"VoxelWorld/world.html",title:"Voxel World",width:"900",height:"500",ref:this.worldContainerRef})),l.a.createElement("p",null,"Tip: press 'esc' to leave the voxel world, w/a/s/d to move, space to jump"))}}]),a}(l.a.Component);t.a=c},62:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(7),r=a(6),o=a(0),l=a.n(o),c=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"renderHandshake",value:function(){return this.props.stateManager.socket.emit("receiveTimelineHandshake","Sent message!"),this.props.stateManager.memory.timelineHandshake}},{key:"renderEvent",value:function(){return this.props.stateManager.memory.timelineEvent}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this)}},{key:"render",value:function(){return l.a.createElement("div",{className:"timeline"},l.a.createElement("p",null,"A visualizer where users can easily view, inspect, and search through agent activities interactively."),l.a.createElement("p",null,"Handshake status: ",this.renderHandshake()),l.a.createElement("p",null,"Latest memory event: ",this.renderEvent()))}}]),a}(l.a.Component);t.a=c},67:function(e,t,a){"use strict";var n=a(44),i=a(4),s=a(5),r=a(8),o=a(7),l=a(6),c=a(0),h=a.n(c),u=a(41),d=a(12),m=a(57),p=["rgba(0,200,0,.5)","rgba(200,0,0,.5)","rgba(0,100,255,.5)","rgba(255,150,0,.5)","rgba(100,255,200,.5)","rgba(200,200,0,.5)","rgba(0,200,150,.5)","rgba(200,0,200,.5)","rgba(0,204,255,.5)"],g=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onResize=n.onResize.bind(Object(r.a)(n)),n.onFixup=n.onFixup.bind(Object(r.a)(n)),n.initialState={height:e.height,width:e.width,rgb:null,objects:null},n.state=n.initialState,n}return Object(s.a)(a,[{key:"onResize",value:function(e,t,a,n,i){this.setState({width:parseInt(a.style.width,10),height:parseInt(a.style.height,10)})}},{key:"onFixup",value:function(){if(this.props.stateManager){var e=this.props.stateManager,t=void 0;if(e.refs.forEach((function(e){e instanceof m.a&&(t=e)})),void 0!==t){var a=this.state.objects.map((function(e){return{mask:e.mask?e.mask.map((function(e){return e.map((function(e){return{x:e[0]/500,y:e[1]/500}}))})):[],label:e.label,properties:e.properties.split("\n ")}}));t.setState({image:this.state.rgb,objects:a});for(var n=e.dashboardLayout,i=0;i<n._getAllContentItems().length;i++)if("ObjectFixup"===n._getAllContentItems()[i].config.component){var s=n._getAllContentItems()[i];s.parent.setActiveContentItem(s)}}}}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this)}},{key:"render",value:function(){var e=this.state,t=e.height,a=e.width,i=e.rgb,s=e.objects,r=this.props,o=r.offsetW,l=r.offsetH;if(null===i)return h.a.createElement(u.a,{default:{x:o,y:l,width:a,height:t},lockAspectRatio:!0,onResize:this.onResize},h.a.createElement("p",null,"Loading..."));var c=[],m=s;null===s&&(m=[]);var g=0;return m.forEach((function(e,a){var i=e.id,s=String(i).concat(e.label),r=e.properties,o=p[a%p.length],l=t/512,u=parseInt(e.bbox[0]*l),m=parseInt(e.bbox[1]*l),f=parseInt(e.bbox[2]*l),v=parseInt(e.bbox[3]*l)-m,b=f-u;if(c.push(h.a.createElement(d.Rect,{key:g,x:u,y:m,width:b,height:v,fillEnabled:!1,stroke:o})),c.push(h.a.createElement(d.Text,{key:[g++,s],text:s.concat("\n",r),x:u,y:m,fill:o,fontSize:10})),e&&e.mask)for(var y=function(t){var a=e.mask[t].map((function(e){return[e[0]*l,e[1]*l]}));c.push(h.a.createElement(d.Shape,{sceneFunc:function(e,t){e.beginPath(),e.moveTo.apply(e,Object(n.a)(a[0]));for(var i=1;i<a.length;i++)e.lineTo.apply(e,Object(n.a)(a[i]));e.closePath(),e.fillStrokeShape(t)},fill:o,opacity:.5,stroke:"black",strokeWidth:1}))},k=0;k<e.mask.length;k++)y(k)})),h.a.createElement(u.a,{default:{x:o,y:l,width:a,height:t},lockAspectRatio:!0,onResize:this.onResize},h.a.createElement(d.Stage,{width:a,height:t},h.a.createElement(d.Layer,null,h.a.createElement(d.Image,{image:i,width:a,height:t}),c)),h.a.createElement("button",{onClick:this.onFixup},"Fix"))}}]),a}(h.a.Component);t.a=g},68:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(7),r=a(6),o=a(0),l=a.n(o),c=a(190),h=a(188),u=a(189),d=(a(132),function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"renderChatHistory",value:function(){return this.props.stateManager.memory.chats.map((function(e,t){return l.a.cloneElement(l.a.createElement(h.a,{alignItems:"flex-start"},l.a.createElement("div",{className:"chatItem"},""!==e.msg?l.a.createElement(u.a,{primary:e.msg}):null)),{key:t.toString()})}))}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this)}},{key:"render",value:function(){return l.a.createElement("div",{className:"history"},l.a.createElement("p",null,"The history of the last 5 commands sent to the bot."),l.a.createElement(c.a,null,this.renderChatHistory()))}}]),a}(l.a.Component));t.a=d},77:function(e,t,a){"use strict";var n=a(40),i=a(4),s=a(5),r=a(7),o=a(6),l=a(0),c=a.n(l),h=a(36),u=a(35);function d(e){return null===e.value||void 0===e.value?null:c.a.createElement(c.a.Fragment,null,c.a.createElement(h.a,{item:!0,xs:4,s:4},c.a.createElement(u.a,{variant:"button",align:"right"},e.title)),c.a.createElement(h.a,{item:!0,xs:8,s:8},c.a.createElement(u.a,{variant:"body1",align:"left"},e.value)))}var m=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=(0,Object(n.a)(this.props.memoryManager,3)[2])(this.props.uuid);return c.a.createElement(h.a,{container:!0,spacing:2,style:{padding:"16px"}},c.a.createElement(h.a,{item:!0,xs:11},c.a.createElement(u.a,{variant:"h4",align:"left"},"Attributes")),c.a.createElement(d,{title:"UUID",value:e.data[0]}),c.a.createElement(d,{title:"ID",value:e.data[1]}),c.a.createElement(d,{title:"X",value:e.data[2]}),c.a.createElement(d,{title:"Y",value:e.data[3]}),c.a.createElement(d,{title:"Z",value:e.data[4]}),c.a.createElement(d,{title:"Yaw",value:e.data[5]}),c.a.createElement(d,{title:"Pitch",value:e.data[6]}),c.a.createElement(d,{title:"Type",value:e.data[9]}),c.a.createElement(d,{title:"Name",value:e.data[7]}),c.a.createElement(h.a,{item:!0,xs:12},c.a.createElement(u.a,{variant:"h4",align:"left"},"Triples")),c.a.createElement(h.a,{item:!0,xs:4},c.a.createElement(u.a,{variant:"button",align:"left"},"Predicate")),c.a.createElement(h.a,{item:!0,xs:4},c.a.createElement(u.a,{variant:"button",align:"left"},"Value")),c.a.createElement(h.a,{item:!0,xs:4},c.a.createElement(u.a,{variant:"button",align:"left"},"Confidence")),e.triples.map((function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(h.a,{item:!0,xs:4},c.a.createElement(u.a,{variant:"body2",align:"left"},e[4])),c.a.createElement(h.a,{item:!0,xs:4},c.a.createElement(u.a,{variant:"body2",align:"left"},e[6])),c.a.createElement(h.a,{item:!0,xs:4},c.a.createElement(u.a,{variant:"body2",align:"left"},e[7])))})))}}]),a}(c.a.Component);t.a=m},78:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(7),r=a(6),o=a(0),l=a.n(o),c=a(424),h=a(425),u=a(428),d=(a(133),function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state=e.state,i}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement(h.a,{className:"Navbar"},l.a.createElement(u.a,null,l.a.createElement("button",{className:"button",onClick:function(){return e.props.paneHandler("home")}},"Home"),l.a.createElement("button",{className:"button",onClick:function(){return e.props.paneHandler("navigation")}},"Navigation"),l.a.createElement("button",{className:"button",onClick:function(){return e.props.paneHandler("settings")}},"Settings"),l.a.createElement("button",{className:"button",onClick:function(){return e.props.paneHandler("annotation")}},"Annotation")))}}]),a}(l.a.Component)),m=a(422),p=a(423),g=a(23),f=a(38),v=a(13),b=a(43),y=a(39),k=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(m.a,null,l.a.createElement(p.a,null,"Video Feed 1",l.a.createElement(g.a,{type:"rgb",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0})),l.a.createElement(p.a,null,"Memory 2d",l.a.createElement(y.a,{stateManager:v.a,isMobile:!0,dimensions:this.props.imageWidth}))),l.a.createElement(m.a,null,l.a.createElement(p.a,null,"Video Feed 2",l.a.createElement(g.a,{type:"depth",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0})),l.a.createElement(p.a,null,"Video Feed 3",l.a.createElement(f.a,{type:"depth",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0}))),l.a.createElement(m.a,null,l.a.createElement(b.a,{stateManager:v.a,isMobile:!0})))}}]),a}(l.a.Component),M=(a(134),function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).state={commands:[]},i.intervalId=void 0,i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.intervalId=setInterval(this.sendAndClearCommands.bind(this),33.33)}},{key:"componentWillUnmount",value:function(){this.intervalId&&clearInterval(this.intervalId)}},{key:"addCommand",value:function(e){var t=this.state.commands;t.push(e),this.setState({commands:t})}},{key:"sendAndClearCommands",value:function(){this.state&&(v.a.buttonHandler(this.state.commands),this.setState({commands:[]}))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"container"},l.a.createElement("button",{className:"directionButton left",onClick:function(){return e.addCommand("MOVE_LEFT")}},"LEFT"),l.a.createElement("button",{className:"directionButton up",onClick:function(){return e.addCommand("MOVE_FORWARD")}},"UP"),l.a.createElement("button",{className:"directionButton down",onClick:function(){return e.addCommand("MOVE_DOWN")}},"DOWN"),l.a.createElement("button",{className:"directionButton right",onClick:function(){return e.addCommand("MOVE_RIGHT")}},"RIGHT"))}}]),a}(l.a.Component)),E=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(m.a,null,l.a.createElement(p.a,null,"Video Feed 1",l.a.createElement(g.a,{type:"rgb",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0})),l.a.createElement(p.a,null,"Memory 2d",l.a.createElement(y.a,{stateManager:v.a,isMobile:!0,dimensions:this.props.imageWidth}))),l.a.createElement(m.a,null,l.a.createElement(p.a,null,"Video Feed 2",l.a.createElement(g.a,{type:"depth",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0})),l.a.createElement(p.a,null,"Video Feed 3",l.a.createElement(f.a,{type:"depth",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0}))),l.a.createElement(M,null))}}]),a}(l.a.Component),w=a(53),x=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(m.a,null,l.a.createElement(p.a,null,"Video Feed 1",l.a.createElement(g.a,{type:"rgb",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0})),l.a.createElement(p.a,null,"Memory 2d",l.a.createElement(y.a,{stateManager:v.a,isMobile:!0,dimensions:this.props.imageWidth}))),l.a.createElement(m.a,null,l.a.createElement(p.a,null,"Video Feed 2",l.a.createElement(g.a,{type:"depth",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0})),l.a.createElement(p.a,null,"Video Feed 3",l.a.createElement(f.a,{type:"depth",height:this.props.imageWidth,width:this.props.imageWidth,offsetH:0,offsetW:0,stateManager:v.a,isMobile:!0}))),l.a.createElement(w.a,{stateManager:v.a,isMobile:!0}))}}]),a}(l.a.Component),O=a(57),j=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var i;Object(n.a)(this,a);var s=window.innerWidth;return(i=t.call(this,e)).state={screen:"home",imageWidth:.4*s,objectRGB:null},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){v.a&&v.a.connect(this)}},{key:"paneHandler",value:function(e){this.setState({screen:e})}},{key:"render",value:function(){var e;return"home"===this.state.screen?e=l.a.createElement(k,{imageWidth:this.state.imageWidth}):"navigation"===this.state.screen?e=l.a.createElement(E,{imageWidth:this.state.imageWidth}):"settings"===this.state.screen?e=l.a.createElement(x,{imageWidth:this.state.imageWidth}):"annotation"===this.state.screen&&(e=l.a.createElement(O.a,{imageWidth:window.innerWidth-25,image:this.state.objectRGB,stateManager:v.a,isMobile:!0})),l.a.createElement(c.a,{fluid:!0},e,l.a.createElement(d,{paneHandler:this.paneHandler.bind(this)}))}}]),a}(l.a.Component);t.a=j},79:function(e,t,a){"use strict";var n=a(4),i=a(5),s=a(8),r=a(7),o=a(6),l=a(0),c=a.n(l),h=a(40),u=a(63),d=a(64),m=a(51),p=a(10),g=a(15),f=a(430),v=a(74),b=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).getRowClassName=function(t){var a=t.index,n=e.props,i=n.classes,s=n.onRowClick;return Object(p.a)(i.tableRow,i.flexContainer,Object(m.a)({},i.tableRowHover,-1!==a&&null!=s))},e.cellRenderer=function(t){var a=t.cellData,n=t.columnIndex,i=e.props,s=i.columns,r=i.classes,o=i.rowHeight,l=i.onRowClick;return c.a.createElement(f.a,{component:"div",className:Object(p.a)(r.tableCell,r.flexContainer,Object(m.a)({},r.noClick,null==l)),variant:"body",style:{height:o},align:null!=n&&s[n].numeric?"right":"left"},a)},e.headerRenderer=function(t){var a=t.label,n=t.columnIndex,i=e.props,s=i.headerHeight,r=i.columns,o=i.classes;return c.a.createElement(f.a,{component:"div",className:Object(p.a)(o.tableCell,o.flexContainer,o.noClick),variant:"head",style:{height:s},align:r[n].numeric?"right":"left"},c.a.createElement("span",null,a))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.height,n=t.width,i=t.classes,s=t.columns,r=t.rowHeight,o=t.headerHeight,l=Object(d.a)(t,["height","width","classes","columns","rowHeight","headerHeight"]);return c.a.createElement(v.c,Object.assign({height:a,width:n,rowHeight:r,gridStyle:{direction:"inherit"},size:"small",headerHeight:o,className:i.table},l,{rowClassName:this.getRowClassName}),s.map((function(t,a){var n=t.dataKey,s=Object(d.a)(t,["dataKey"]);return c.a.createElement(v.b,Object.assign({key:n,headerRenderer:function(t){return e.headerRenderer(Object(u.a)(Object(u.a)({},t),{},{columnIndex:a}))},className:i.flexContainer,cellRenderer:e.cellRenderer,dataKey:n},s))})))}}]),a}(c.a.PureComponent);b.defaultProps={headerHeight:48,rowHeight:36};var y=Object(g.a)((function(e){return{flexContainer:{display:"flex",alignItems:"center",boxSizing:"border-box"},table:{"& .ReactVirtualized__Table__headerRow":{flip:!1,paddingRight:"rtl"===e.direction?"0 !important":void 0}},tableRow:{cursor:"pointer"},tableRowHover:{"&:hover":{backgroundColor:e.palette.action.hover}},tableCell:{flex:1},noClick:{cursor:"initial"}}}))(b);function k(e){var t=e.memoryManager,a=e.onShowMemoryDetail,n=Object(h.a)(t,2),i=n[0],s=n[1];return c.a.createElement(v.a,null,(function(e){var t=e.height,n=e.width;return c.a.createElement(y,{height:t,width:n,rowCount:i(),rowGetter:function(e){var t,a=e.index;return{uuid:(t=s(a)).data[0],id:t.data[1],type:t.data[9],name:t.data[7]}},onRowClick:function(e){e.event,e.index;var t=e.rowData;t&&t.uuid&&a(t.uuid)},columns:[{flexGrow:1,width:1,label:"ID",dataKey:"id",numeric:!0},{flexGrow:5,width:5,label:"Type",dataKey:"type",numeric:!1},{flexGrow:5,width:5,label:"Name",dataKey:"name",numeric:!1}]})}))}var M=a(118);function E(e,t){e.memories,e.named_abstractions;var a=e.reference_objects,n=e.triples,i=new Map(a.map((function(e){return[e[0],{data:e}]})));n&&n.forEach((function(e){var t=e[1],a=i.get(t);a&&(a.triples?a.triples.push(e):a.triples=[e])}));var s=[];if(null!=t&&t.length>0){var r,o=Object(M.a)(i.values());try{for(o.s();!(r=o.n()).done;){var l=r.value;JSON.stringify(l).includes(t)&&s.push(l)}}catch(c){o.e(c)}finally{o.f()}}else s=Array.from(i.values());return[function(){return s.length},function(e){return s[e]},function(e){return i.get(e)}]}var w=a(77),x=a(426),O=a(431),j=a(420),I=a(119),C=a.n(I),S=a(421),_=a(250),R=a(418),H=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).initialState={height:400,width:600,isLoaded:!1,memory:null,filter:"",showDetail:!1,detailUUID:null},i.state=i.initialState,i.outer_div=c.a.createRef(),i.resizeHandler=i.resizeHandler.bind(Object(s.a)(i)),i}return Object(i.a)(a,[{key:"resizeHandler",value:function(){if(null!=this.outer_div&&null!=this.outer_div.current){var e=this.outer_div.current,t=e.clientHeight,a=e.clientWidth;(void 0!==t&&t!==this.state.height||void 0!==a&&a!==this.state.width)&&this.setState({height:t,width:a})}}},{key:"componentDidMount",value:function(){this.props.stateManager&&this.props.stateManager.connect(this),void 0!==this.props.glContainer&&this.props.glContainer.on("resize",this.resizeHandler)}},{key:"componentDidUpdate",value:function(e,t){this.resizeHandler()}},{key:"render",value:function(){var e=this;if(!this.state.isLoaded)return c.a.createElement("p",null,"Loading");var t=this.state,a=t.height,n=t.width,i=t.memory,s=t.isLoaded;if(0===a&&0===n)return c.a.createElement("div",{ref:this.outer_div,style:{height:"100%",width:"100%"}});if(!s)return c.a.createElement("div",{ref:this.outer_div,style:{height:"100%",width:"100%"}},"Loading...");var r=Object(_.a)({palette:{type:"dark"}}),o=new E(i,this.state.filter),l=this.state.height-24,h=this.state.width-24,u=function(){e.setState({showDetail:!1})};return c.a.createElement(R.a,{theme:r},c.a.createElement(x.a,{style:{borderBlockColor:"white"},color:"primary",id:"outlined-uncontrolled",label:"Search",margin:"dense",variant:"outlined",onChange:function(t){e.setState({filter:t.target.value})}}),c.a.createElement(k,{height:l,width:h,memoryManager:o,onShowMemoryDetail:function(t){e.setState({detailUUID:t,showDetail:!0})}}),c.a.createElement(O.a,{anchor:"right",open:this.state.showDetail,onClose:function(){u()}},c.a.createElement("div",{style:{width:450}},c.a.createElement(j.a,{onClick:function(){return u()}},c.a.createElement(C.a,null)),c.a.createElement(S.a,null),c.a.createElement(w.a,{memoryManager:o,uuid:this.state.detailUUID}))))}}]),a}(c.a.Component);t.a=H}},[[381,157,0,1]]]);